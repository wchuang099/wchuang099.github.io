<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
<head>
  <!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="一、文件的读取和导入# 数据读取# import pandas as pd print(pd.__version__) #查看版本 # 读取 csv df_csv = pd.read_csv(r&#34;data/my_csv.csv&#34;) # 推荐使用相对路径 # 读取 txt df_txt = pd.read_table(r&#34;data/my_table.txt&#34;) # 读取 excel df_excel = pd.read_excel(r&#34;data/my_excel.xlsx&#34;)常用参数：
header=None 第一行不作为列名 index_col 指定某列作为索引 usecols 指定读取的列 parse_dates 指定需要转为时间的列 nrows 指定读取的行数 指定分隔符 sep
sep=’,’ → 逗号分隔 sep=’\t’ → 制表符分隔（read_table 默认就是 \t） sep=’\s&#43;’ → 多个空格分隔 sep=’;’ → 分号分隔 read_csv() 默认 sep=&#39;,&#39;，读取 csv 文件无需显式写 sep=&#39;,&#39;。 read_table() 默认 sep=&#39;\t&#39;，所以读取制表符 txt 文件可以直接用，不用改 sep。 read_excel 不需要 sep，因为 Excel 文件本身有单元格结构，不是纯文本分隔的。
数据写入# 常用：index=False 避免保存索引
df_csv.to_csv(r&#34;data/my_csv_saved.csv&#34;, index=False) df_excel.to_excel(r&#34;data/my_excel_saved.xlsx&#34;, index=False) df_txt.to_csv(r&#34;data/my_table_saved.txt&#34;, sep=&#39;\t&#39;, index=False)如果想要把表格转换为 markdown 和 latex 语言，可以使用 to_markdown 和 to_latex 函数，此处需要安装 tabulate 包。
">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/Python/Python%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/1.Pandas%E5%9F%BA%E7%A1%80/">
  <meta property="og:site_name" content="碎碎念念">
  <meta property="og:title" content="Pandas基础">
  <meta property="og:description" content="一、文件的读取和导入# 数据读取# import pandas as pd print(pd.__version__) #查看版本 # 读取 csv df_csv = pd.read_csv(r&#34;data/my_csv.csv&#34;) # 推荐使用相对路径 # 读取 txt df_txt = pd.read_table(r&#34;data/my_table.txt&#34;) # 读取 excel df_excel = pd.read_excel(r&#34;data/my_excel.xlsx&#34;)常用参数：
header=None 第一行不作为列名 index_col 指定某列作为索引 usecols 指定读取的列 parse_dates 指定需要转为时间的列 nrows 指定读取的行数 指定分隔符 sep
sep=’,’ → 逗号分隔 sep=’\t’ → 制表符分隔（read_table 默认就是 \t） sep=’\s&#43;’ → 多个空格分隔 sep=’;’ → 分号分隔 read_csv() 默认 sep=&#39;,&#39;，读取 csv 文件无需显式写 sep=&#39;,&#39;。 read_table() 默认 sep=&#39;\t&#39;，所以读取制表符 txt 文件可以直接用，不用改 sep。 read_excel 不需要 sep，因为 Excel 文件本身有单元格结构，不是纯文本分隔的。
数据写入# 常用：index=False 避免保存索引
df_csv.to_csv(r&#34;data/my_csv_saved.csv&#34;, index=False) df_excel.to_excel(r&#34;data/my_excel_saved.xlsx&#34;, index=False) df_txt.to_csv(r&#34;data/my_table_saved.txt&#34;, sep=&#39;\t&#39;, index=False)如果想要把表格转换为 markdown 和 latex 语言，可以使用 to_markdown 和 to_latex 函数，此处需要安装 tabulate 包。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="python">


  <meta itemprop="name" content="Pandas基础">
  <meta itemprop="description" content="一、文件的读取和导入# 数据读取# import pandas as pd print(pd.__version__) #查看版本 # 读取 csv df_csv = pd.read_csv(r&#34;data/my_csv.csv&#34;) # 推荐使用相对路径 # 读取 txt df_txt = pd.read_table(r&#34;data/my_table.txt&#34;) # 读取 excel df_excel = pd.read_excel(r&#34;data/my_excel.xlsx&#34;)常用参数：
header=None 第一行不作为列名 index_col 指定某列作为索引 usecols 指定读取的列 parse_dates 指定需要转为时间的列 nrows 指定读取的行数 指定分隔符 sep
sep=’,’ → 逗号分隔 sep=’\t’ → 制表符分隔（read_table 默认就是 \t） sep=’\s&#43;’ → 多个空格分隔 sep=’;’ → 分号分隔 read_csv() 默认 sep=&#39;,&#39;，读取 csv 文件无需显式写 sep=&#39;,&#39;。 read_table() 默认 sep=&#39;\t&#39;，所以读取制表符 txt 文件可以直接用，不用改 sep。 read_excel 不需要 sep，因为 Excel 文件本身有单元格结构，不是纯文本分隔的。
数据写入# 常用：index=False 避免保存索引
df_csv.to_csv(r&#34;data/my_csv_saved.csv&#34;, index=False) df_excel.to_excel(r&#34;data/my_excel_saved.xlsx&#34;, index=False) df_txt.to_csv(r&#34;data/my_table_saved.txt&#34;, sep=&#39;\t&#39;, index=False)如果想要把表格转换为 markdown 和 latex 语言，可以使用 to_markdown 和 to_latex 函数，此处需要安装 tabulate 包。">
  <meta itemprop="wordCount" content="727">

<title>Pandas基础 | 碎碎念念</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/Python/Python%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/1.Pandas%E5%9F%BA%E7%A1%80/">
<link rel="stylesheet" href="/book.min.d001b688465bfefc82049e01ae748ce2a5b3d7da2ae566f7623a5daac2ddea10.css" integrity="sha256-0AG2iEZb/vyCBJ4BrnSM4qWz19oq5Wb3YjpdqsLd6hA=" crossorigin="anonymous">


  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.9d4fa0048b4786d5be096d98c61a47e02072a87b9dbf0bb86dcd8edf179c4e43.js" integrity="sha256-nU&#43;gBItHhtW&#43;CW2YxhpH4CByqHudvwu4bc2O3xecTkM=" crossorigin="anonymous"></script>



  
</head>
<body dir="ltr" class="book-kind-page book-type-python">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>碎碎念念</span>
  </a>
</h2>


<div class="book-search hidden">
  <input id="book-search-input" type="text" 
    placeholder="Search"
    aria-label="Search"
    maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>











  



  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-204365caa941390a182aeb870c8b397d" class="toggle" checked />
    <label for="section-204365caa941390a182aeb870c8b397d" class="flex">
      <a role="button" class="">
        Python</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f6929f8819239c236e3ff6d9318a645b" class="toggle"  />
    <label for="section-f6929f8819239c236e3ff6d9318a645b" class="flex">
      <a role="button" class="">
        Python基础知识</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/Python/Python%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" class="">
      基础知识</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/Python%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%A3%85%E9%A5%B0%E5%99%A8/" class="">
      Python函数</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/Python%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/functools/" class="">
      functools</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-797baf87757652be835bcce5680ea0d4" class="toggle"  />
    <label for="section-797baf87757652be835bcce5680ea0d4" class="flex">
      <a role="button" class="">
        Python应用代码</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/Python/Python%E5%BA%94%E7%94%A8%E4%BB%A3%E7%A0%81/Jupyter%E4%BD%BF%E7%94%A8/" class="">
      Jupyter使用</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/Python%E5%BA%94%E7%94%A8%E4%BB%A3%E7%A0%81/Loguru-%E5%89%AF%E6%9C%AC/" class="">
      Loguru</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/Python%E5%BA%94%E7%94%A8%E4%BB%A3%E7%A0%81/Loguru/" class="">
      Loguru</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/Python%E5%BA%94%E7%94%A8%E4%BB%A3%E7%A0%81/PySimpleGUI/" class="">
      PySimpleGUI</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/Python%E5%BA%94%E7%94%A8%E4%BB%A3%E7%A0%81/watchdog/" class="">
      WatchDog</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/Python%E5%BA%94%E7%94%A8%E4%BB%A3%E7%A0%81/schedule/" class="">
      定时任务-schedule</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/Python%E5%BA%94%E7%94%A8%E4%BB%A3%E7%A0%81/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/" class="">
      配置文件</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/Python%E5%BA%94%E7%94%A8%E4%BB%A3%E7%A0%81/Fastapi-WEB%E5%BC%80%E5%8F%91/" class="">
      fastapi</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/Python%E5%BA%94%E7%94%A8%E4%BB%A3%E7%A0%81/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BC%80%E5%8F%91/" class="">
      数据库开发</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/Python%E5%BA%94%E7%94%A8%E4%BB%A3%E7%A0%81/%E4%B8%80%E4%BA%9B%E8%A7%84%E8%8C%83/" class="">
      一些规范</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-0fa9f382cfc268805da9afbea1ac822b" class="toggle" checked />
    <label for="section-0fa9f382cfc268805da9afbea1ac822b" class="flex">
      <a role="button" class="">
        Python数据处理</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/Python/Python%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/Numpy/" class="">
      Numpy</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/Python%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/1.Pandas%E5%9F%BA%E7%A1%80/" class="active">
      Pandas基础</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/Python%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/2.Pandas%E7%B4%A2%E5%BC%95/" class="">
      Pandas索引</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/Python%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/3.Pandas%E5%88%86%E7%BB%84/" class="">
      Pandas分组</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/Python%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/4.Pandas%E5%8F%98%E5%BD%A2/" class="">
      Pandas变形</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-938c3edbaa8e3dd01e8b93d6f9361182" class="toggle"  />
    <label for="section-938c3edbaa8e3dd01e8b93d6f9361182" class="flex">
      <a role="button" class="">
        Pyside-GUI开发</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/Python/Pyside/pyside%E5%9F%BA%E7%A1%80/" class="">
      PySide基础</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/Pyside/%E7%BE%8E%E5%8C%96%E7%95%8C%E9%9D%A2css/" class="">
      PySide美化界面</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/Pyside/%E4%BF%A1%E5%8F%B7%E6%A7%BD%E4%B8%8E%E5%A4%9A%E7%BA%BF%E7%A8%8B/" class="">
      PySide信号槽与多线程</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-56b62cfe8bd1e3138f346455c7c08d01" class="toggle"  />
    <label for="section-56b62cfe8bd1e3138f346455c7c08d01" class="flex">
      <a role="button" class="">
        其它知识</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/Python/%E5%85%B6%E4%BB%96%E7%9F%A5%E8%AF%86/Pystand/" class="">
      Pystand打包工具</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/%E5%85%B6%E4%BB%96%E7%9F%A5%E8%AF%86/Conda/" class="">
      Conda使用教程</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Python/%E5%85%B6%E4%BB%96%E7%9F%A5%E8%AF%86/MinGit%E4%BD%BF%E7%94%A8/" class="">
      MinGit使用</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-e12d76c83fadc5077063bd8a06e4974c" class="toggle"  />
    <label for="section-e12d76c83fadc5077063bd8a06e4974c" class="flex">
      <a role="button" class="">
        Linux</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/Linux/git/Git%E5%9F%BA%E7%A1%80/" class="">
      Git使用教程</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Linux/install-docker/" class="">
      安装 Docker 教程</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Linux/install-mysql/" class="">
      安装 mysql 教程</a>
  

        </li>
      
    
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-23e22f2cefc5200495b10b220f00dc9b" class="toggle"  />
    <label for="section-23e22f2cefc5200495b10b220f00dc9b" class="flex">
      <a role="button" class="">
        Windows</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/Windows/nssm%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/" class="">
      nssm进程管理工具</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-5f3519d07421b3022c482beb7e53757d" class="toggle"  />
    <label for="section-5f3519d07421b3022c482beb7e53757d" class="flex">
      <a role="button" class="">
        Other</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/Other/hugo/" class="">
      hugo使用</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Other/Markdown%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/" class="">
      Markdown使用教程</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Other/%E5%A6%82%E4%BD%95%E7%BB%84%E8%A3%85%E4%B8%80%E5%8F%B0%E4%B8%BB%E6%9C%BA/" class="">
      志强平台装机流程</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-00896273d6e22b6628839c56863edc57" class="toggle"  />
    <label for="section-00896273d6e22b6628839c56863edc57" class="flex">
      <a role="button" class="">
        Game</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-212fbf26dee144498e07df6cb6c18024" class="toggle"  />
    <label for="section-212fbf26dee144498e07df6cb6c18024" class="flex">
      <a role="button" class="">
        Yolo</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/Game/Yolo/yolo%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/" class="">
      YOLO环境安装</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Game/Yolo/YOLO%E6%A0%87%E6%B3%A8%E5%92%8C%E8%AE%AD%E7%BB%83%E6%95%B0%E6%8D%AE/" class="">
      YOLO标注和训练数据</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Game/%E9%BC%A0%E6%A0%87%E6%BC%82%E7%A7%BB/" class="">
      处理鼠标漂移</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Game/%E5%A4%A7%E6%BC%A0%E6%8F%92%E4%BB%B6/" class="">
      大漠插件</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-5b47f8600929668d6470260320a7fd81" class="toggle"  />
    <label for="section-5b47f8600929668d6470260320a7fd81" class="flex">
      <a href="/Game/%E5%B9%BD%E7%81%B5%E9%94%AE%E9%BC%A0/" class="">
        幽灵键鼠</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a>
      易键鼠</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Game/%E6%B8%B8%E6%88%8F%E8%84%9A%E6%9C%AC%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%9A%94%E7%A6%BB%E6%96%B9%E6%A1%88/" class="">
      脚本隔离方案</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-c5a43b1f0709f0338f2ab4a52452792c" class="toggle"  />
    <label for="section-c5a43b1f0709f0338f2ab4a52452792c" class="flex">
      <a role="button" class="">
        逆向初级</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/Game/%E9%80%86%E5%90%91%E5%88%9D%E7%BA%A7/01.%E8%BF%9B%E5%88%B6%E5%9F%BA%E7%A1%80/" class="">
      01.进制基础</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Game/%E9%80%86%E5%90%91%E5%88%9D%E7%BA%A7/02.%E6%95%B0%E6%8D%AE%E5%AE%BD%E5%BA%A6/" class="">
      02.数据宽度</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Game/%E9%80%86%E5%90%91%E5%88%9D%E7%BA%A7/03.%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97/" class="">
      03.逻辑运算</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Game/%E9%80%86%E5%90%91%E5%88%9D%E7%BA%A7/04.%E5%AF%84%E5%AD%98%E5%99%A8/" class="">
      04.寄存器</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/Game/%E9%80%86%E5%90%91%E5%88%9D%E7%BA%A7/05.%E5%86%85%E5%AD%98/" class="">
      05.内存</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>













</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>



  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header hidden">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/icons/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>Pandas基础</h3>

  <label for="toc-control">
    
    <img src="/icons/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#一文件的读取和导入">一、文件的读取和导入</a>
      <ul>
        <li><a href="#数据读取">数据读取</a></li>
        <li><a href="#数据写入">数据写入</a></li>
      </ul>
    </li>
    <li><a href="#二基本数据结构">二、基本数据结构</a>
      <ul>
        <li><a href="#1-series">1. Series</a></li>
        <li><a href="#2-dataframe">2. DataFrame</a></li>
        <li><a href="#常用属性">常用属性</a></li>
      </ul>
    </li>
    <li><a href="#三常用基本函数">三、常用基本函数</a>
      <ul>
        <li><a href="#1汇总函数快速查看数据">1.汇总函数（快速查看数据）</a></li>
        <li><a href="#2特征统计函数对数值列操作">2、特征统计函数（对数值列操作）</a></li>
        <li><a href="#3唯一值函数处理分类--文本列">3、唯一值函数（处理分类 / 文本列）</a></li>
        <li><a href="#4替换函数replace">4、替换函数（replace）</a></li>
        <li><a href="#5排序函数sorting">5、排序函数（Sorting）</a></li>
        <li><a href="#6apply方法数据转换利器">6、apply方法（数据转换利器）</a></li>
      </ul>
    </li>
    <li><a href="#四窗口函数window-functions">四、窗口函数（Window Functions）</a>
      <ul>
        <li><a href="#滑动窗口">滑动窗口</a></li>
        <li><a href="#扩张窗口">扩张窗口</a></li>
        <li><a href="#指数加权窗口">指数加权窗口：</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h2 id="一文件的读取和导入">一、文件的读取和导入<a class="anchor" href="#%e4%b8%80%e6%96%87%e4%bb%b6%e7%9a%84%e8%af%bb%e5%8f%96%e5%92%8c%e5%af%bc%e5%85%a5">#</a></h2>
<h3 id="数据读取">数据读取<a class="anchor" href="#%e6%95%b0%e6%8d%ae%e8%af%bb%e5%8f%96">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span>print(pd<span style="color:#f92672">.</span>__version__)  <span style="color:#75715e">#查看版本</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 读取 csv</span>
</span></span><span style="display:flex;"><span>df_csv <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;data/my_csv.csv&#34;</span>)  <span style="color:#75715e"># 推荐使用相对路径</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 读取 txt</span>
</span></span><span style="display:flex;"><span>df_txt <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_table(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;data/my_table.txt&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 读取 excel</span>
</span></span><span style="display:flex;"><span>df_excel <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;data/my_excel.xlsx&#34;</span>)</span></span></code></pre></div><p>常用参数：</p>
<ul>
<li>header=None      第一行不作为列名</li>
<li>index_col        指定某列作为索引</li>
<li>usecols          指定读取的列</li>
<li>parse_dates      指定需要转为时间的列</li>
<li>nrows            指定读取的行数</li>
</ul>
<p>指定分隔符 sep</p>
<ul>
<li>sep=&rsquo;,&rsquo; → 逗号分隔</li>
<li>sep=&rsquo;\t&rsquo; → 制表符分隔（read_table 默认就是 \t）</li>
<li>sep=&rsquo;\s+&rsquo; → 多个空格分隔</li>
<li>sep=&rsquo;;&rsquo; → 分号分隔</li>
</ul>
<blockquote class='book-hint '>
<p><code>read_csv()</code> 默认 <code>sep=','</code>，读取 csv 文件无需显式写 <code>sep=','</code>。
<code>read_table()</code> 默认 <code>sep='\t'</code>，所以读取制表符 txt 文件可以直接用，不用改 sep。
<code>read_excel</code> 不需要 <code>sep</code>，因为 Excel 文件本身有单元格结构，不是纯文本分隔的。</p></blockquote><h3 id="数据写入">数据写入<a class="anchor" href="#%e6%95%b0%e6%8d%ae%e5%86%99%e5%85%a5">#</a></h3>
<p>常用：index=False 避免保存索引</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_csv<span style="color:#f92672">.</span>to_csv(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;data/my_csv_saved.csv&#34;</span>, index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>df_excel<span style="color:#f92672">.</span>to_excel(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;data/my_excel_saved.xlsx&#34;</span>, index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>df_txt<span style="color:#f92672">.</span>to_csv(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;data/my_table_saved.txt&#34;</span>, sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#39;</span>, index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)</span></span></code></pre></div><p>如果想要把表格转换为 markdown 和 latex 语言，可以使用 to_markdown 和 to_latex 函数，此处需要安装 tabulate 包。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df_csv<span style="color:#f92672">.</span>to_markdown()
</span></span><span style="display:flex;"><span>df_csv<span style="color:#f92672">.</span>to_latex()</span></span></code></pre></div><h2 id="二基本数据结构">二、基本数据结构<a class="anchor" href="#%e4%ba%8c%e5%9f%ba%e6%9c%ac%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84">#</a></h2>
<h3 id="1-series">1. Series<a class="anchor" href="#1-series">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>s <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([<span style="color:#ae81ff">100</span>, <span style="color:#e6db74">&#39;a&#39;</span>, {<span style="color:#e6db74">&#39;dic1&#39;</span>: <span style="color:#ae81ff">5</span>}, <span style="color:#ae81ff">1</span>],
</span></span><span style="display:flex;"><span>              index<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>Index([<span style="color:#e6db74">&#39;id1&#39;</span>, <span style="color:#ae81ff">20</span>, <span style="color:#e6db74">&#39;third&#39;</span>, <span style="color:#e6db74">&#39;id2&#39;</span>], name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;my_idx&#39;</span>),
</span></span><span style="display:flex;"><span>              dtype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;object&#39;</span>,
</span></span><span style="display:flex;"><span>              name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;my_name&#39;</span>)</span></span></code></pre></div><p><strong>常用属性</strong></p>
<ul>
<li><strong>s.values</strong>
返回 Series 的 <strong>数据值</strong>（NumPy 数组形式）
例子输出：<code>array([100, 'a', {'dic1':5}, 1], dtype=object)</code></li>
<li><strong>s.index</strong>
返回 Series 的 <strong>索引</strong>（Index 对象）
例子输出：<code>Index(['id1', 20, 'third', 'id2'], dtype='object', name='my_idx')</code>
可以用来访问或操作索引</li>
<li><strong>s.dtype</strong>
返回 Series <strong>数据类型</strong>
例子输出：<code>object</code>
因为这里混合了数字、字符串和字典，所以 dtype 是 <code>object</code></li>
<li><strong>s.name</strong>
返回 Series 的 <strong>名称</strong>
例子输出：<code>'my_name'</code>
方便在 DataFrame 中作为列名使用</li>
<li><strong>s.shape</strong>
返回 Series 的 <strong>形状</strong>
例子输出：<code>(4,)</code> → 一维，有 4 个元素</li>
<li><strong>s</strong>[&lsquo;id1&rsquo;]
根据索引取单个值
输出：<code>100</code></li>
</ul>
<h3 id="2-dataframe">2. DataFrame<a class="anchor" href="#2-dataframe">#</a></h3>
<pre tabindex="0"><code>data = [[1, &#39;a&#39;, 1.2], [2, &#39;b&#39;, 2.2], [3, &#39;c&#39;, 3.2]]
df = pd.DataFrame(data, index=[&#39;row_0&#39;,&#39;row_1&#39;,&#39;row_2&#39;],
                  columns=[&#39;col_0&#39;,&#39;col_1&#39;,&#39;col_2&#39;])
或使用字典构造：
df = pd.DataFrame({&#39;col_0&#39;:[1,2,3],
                   &#39;col_1&#39;:list(&#39;abc&#39;),
                   &#39;col_2&#39;:[1.2,2.2,3.2]},
                  index=[&#39;row_0&#39;,&#39;row_1&#39;,&#39;row_2&#39;])</code></pre><h3 id="常用属性">常用属性<a class="anchor" href="#%e5%b8%b8%e7%94%a8%e5%b1%9e%e6%80%a7">#</a></h3>
<p><strong>df[[&lsquo;col_0&rsquo;,&lsquo;col_1&rsquo;]]</strong>
获取多列，返回新的 DataFrame</p>
<pre tabindex="0"><code>print(df[[&#39;col_0&#39;,&#39;col_1&#39;]])
# 输出示例：
#       col_0 col_1
# row_0      1     a
# row_1      2     b
# row_2      3     c</code></pre><p><strong>df.values</strong>
返回 DataFrame 的数据值（NumPy 数组形式，不包含列名和索引）</p>
<pre tabindex="0"><code>print(df.values)
# 输出示例：
# [[1 &#39;a&#39; 1.2]
#  [2 &#39;b&#39; 2.2]
#  [3 &#39;c&#39; 3.2]]</code></pre><p><strong>df.index</strong>
返回 DataFrame 的行索引（Index 对象）</p>
<pre tabindex="0"><code>print(df.index)
# 输出示例：
# Index([&#39;row_0&#39;,&#39;row_1&#39;,&#39;row_2&#39;], dtype=&#39;object&#39;)</code></pre><p><strong>df.dtypes</strong>
返回每列的数据类型（Series）</p>
<pre tabindex="0"><code>print(df.dtypes)
# 输出示例：
# col_0      int64
# col_1     object
# col_2    float64
# dtype: object</code></pre><p><strong>df.shape</strong>
返回 DataFrame 形状 (行数, 列数)</p>
<pre tabindex="0"><code>print(df.shape)
# 输出示例：
# (3, 3)</code></pre><p><strong>df.T</strong>
DataFrame 转置，行列互换</p>
<pre tabindex="0"><code>print(df.T)
# 输出示例：
       row_0 row_1 row_2
col_0      1     2     3
col_1      a     b     c
col_2    1.2   2.2   3.2</code></pre><h2 id="三常用基本函数">三、常用基本函数<a class="anchor" href="#%e4%b8%89%e5%b8%b8%e7%94%a8%e5%9f%ba%e6%9c%ac%e5%87%bd%e6%95%b0">#</a></h2>
<p>创建 DataFrame：学生成绩数据</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>data <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;name&#39;</span>: [<span style="color:#e6db74">&#39;张三&#39;</span>, <span style="color:#e6db74">&#39;李四&#39;</span>, <span style="color:#e6db74">&#39;王五&#39;</span>, <span style="color:#e6db74">&#39;赵六&#39;</span>, <span style="color:#e6db74">&#39;陈七&#39;</span>, <span style="color:#e6db74">&#39;张三&#39;</span>, <span style="color:#e6db74">&#39;孙八&#39;</span>, <span style="color:#e6db74">&#39;周九&#39;</span>],
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;class&#39;</span>: [<span style="color:#e6db74">&#39;A班&#39;</span>, <span style="color:#e6db74">&#39;B班&#39;</span>, <span style="color:#e6db74">&#39;A班&#39;</span>, <span style="color:#e6db74">&#39;B班&#39;</span>, <span style="color:#e6db74">&#39;A班&#39;</span>, <span style="color:#e6db74">&#39;A班&#39;</span>, <span style="color:#e6db74">&#39;B班&#39;</span>, <span style="color:#e6db74">&#39;A班&#39;</span>],
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;gender&#39;</span>: [<span style="color:#e6db74">&#39;男&#39;</span>, <span style="color:#e6db74">&#39;男&#39;</span>, <span style="color:#e6db74">&#39;女&#39;</span>, <span style="color:#e6db74">&#39;男&#39;</span>, <span style="color:#e6db74">&#39;女&#39;</span>, <span style="color:#e6db74">&#39;男&#39;</span>, <span style="color:#e6db74">&#39;女&#39;</span>, <span style="color:#e6db74">&#39;男&#39;</span>],
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;math&#39;</span>: [<span style="color:#ae81ff">85</span>, <span style="color:#ae81ff">92</span>, <span style="color:#ae81ff">78</span>, <span style="color:#ae81ff">96</span>, <span style="color:#ae81ff">88</span>, <span style="color:#ae81ff">85</span>, <span style="color:#ae81ff">73</span>, <span style="color:#ae81ff">90</span>],
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;english&#39;</span>: [<span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">85</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">82</span>, <span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">88</span>, <span style="color:#ae81ff">86</span>],
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;science&#39;</span>: [np<span style="color:#f92672">.</span>nan, <span style="color:#ae81ff">88</span>, <span style="color:#ae81ff">85</span>, <span style="color:#ae81ff">92</span>, <span style="color:#ae81ff">78</span>, <span style="color:#ae81ff">95</span>, <span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">84</span>],
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;city&#39;</span>: [<span style="color:#e6db74">&#39;北京&#39;</span>, <span style="color:#e6db74">&#39;上海&#39;</span>, <span style="color:#e6db74">&#39;广州&#39;</span>, <span style="color:#e6db74">&#39;深圳&#39;</span>, <span style="color:#e6db74">&#39;北京&#39;</span>, <span style="color:#e6db74">&#39;北京&#39;</span>, <span style="color:#e6db74">&#39;杭州&#39;</span>, <span style="color:#e6db74">&#39;深圳&#39;</span>]
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(data)</span></span></code></pre></div><h3 id="1汇总函数快速查看数据">1.汇总函数（快速查看数据）<a class="anchor" href="#1%e6%b1%87%e6%80%bb%e5%87%bd%e6%95%b0%e5%bf%ab%e9%80%9f%e6%9f%a5%e7%9c%8b%e6%95%b0%e6%8d%ae">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>head(n) <span style="color:#f92672">-</span> 查看前 n 行
</span></span><span style="display:flex;"><span>print(df<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">3</span>))
</span></span><span style="display:flex;"><span>tail(n) <span style="color:#f92672">-</span> 查看后 n 行
</span></span><span style="display:flex;"><span>print(df<span style="color:#f92672">.</span>tail(<span style="color:#ae81ff">2</span>))
</span></span><span style="display:flex;"><span>info() <span style="color:#f92672">-</span> 查看数据结构<span style="color:#960050;background-color:#1e0010">（</span>列名<span style="color:#960050;background-color:#1e0010">、</span>非空值<span style="color:#960050;background-color:#1e0010">、</span>类型<span style="color:#960050;background-color:#1e0010">）</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>info()
</span></span><span style="display:flex;"><span>describe() <span style="color:#f92672">-</span> 数值列的统计摘要
</span></span><span style="display:flex;"><span>print(df<span style="color:#f92672">.</span>describe())</span></span></code></pre></div><h3 id="2特征统计函数对数值列操作">2、特征统计函数（对数值列操作）<a class="anchor" href="#2%e7%89%b9%e5%be%81%e7%bb%9f%e8%ae%a1%e5%87%bd%e6%95%b0%e5%af%b9%e6%95%b0%e5%80%bc%e5%88%97%e6%93%8d%e4%bd%9c">#</a></h3>
<pre tabindex="0"><code>选择数值列
numeric_cols = [&#39;math&#39;, &#39;english&#39;, &#39;science&#39;]
sum: 求和
print(df[numeric_cols].sum())
mean: 平均值
print(df[numeric_cols].mean())
median: 中位数
print(df[numeric_cols].median())
var: 方差
print(df[numeric_cols].var())
std: 标准差
print(df[numeric_cols].std())
max/min: 最大最小值
print(df[numeric_cols].max())
print(df[numeric_cols].min())
quantile: 分位数
print(&#34;quantile(0.25):\n&#34;, df[numeric_cols].quantile(0.25))
count: 非空值数量（注意：science 少一个）
print(&#34;count:\n&#34;, df[numeric_cols].count())
idxmax: 最大值的索引位置
print(&#34;idxmax (math 最高分是谁?):\n&#34;, df[&#39;math&#39;].idxmax())</code></pre><h3 id="3唯一值函数处理分类--文本列">3、唯一值函数（处理分类 / 文本列）<a class="anchor" href="#3%e5%94%af%e4%b8%80%e5%80%bc%e5%87%bd%e6%95%b0%e5%a4%84%e7%90%86%e5%88%86%e7%b1%bb--%e6%96%87%e6%9c%ac%e5%88%97">#</a></h3>
<pre tabindex="0"><code>unique: 返回唯一值（去重）
print(df[&#39;gender&#39;].unique())
nunique: 唯一值个数
print(df[&#39;class&#39;].nunique())
value_counts: 各值出现次数
print(df[&#39;gender&#39;].value_counts())
duplicated: 返回每行是否是重复行
print(df.duplicated(subset=[&#39;name&#39;]))
drop_duplicates: 删除重复行
df_no_dup = df.drop_duplicates(subset=[&#39;name&#39;], keep=&#39;first&#39;)
print(df_no_dup[[&#39;name&#39;, &#39;math&#39;]])
subset = [&#39;name&#39;]表示按姓名去重，keep = &#39;first&#39;保留第一次出现的</code></pre><h3 id="4替换函数replace">4、替换函数（replace）<a class="anchor" href="#4%e6%9b%bf%e6%8d%a2%e5%87%bd%e6%95%b0replace">#</a></h3>
<p>方法1：单值替换</p>
<pre tabindex="0"><code>df[&#39;gender&#39;] = df[&#39;gender&#39;].replace(&#39;男&#39;, &#39;Male&#39;)
print(&#34;性别替换为英文:\n&#34;, df[[&#39;name&#39;, &#39;gender&#39;]])</code></pre><p>方法2：字典替换</p>
<pre tabindex="0"><code>df[&#39;class&#39;] = df[&#39;class&#39;].replace({&#39;A班&#39;: &#39;Class A&#39;, &#39;B班&#39;: &#39;Class B&#39;})
print(&#34;班级替换:\n&#34;, df[[&#39;name&#39;, &#39;class&#39;]].head(3))</code></pre><p>方法3：用 np.nan 替换异常值</p>
<pre tabindex="0"><code>df[&#39;math&#39;] = df[&#39;math&#39;].replace(96, np.nan)
print(&#34;数学96替换为NaN:\n&#34;, df[[&#39;name&#39;, &#39;math&#39;]].head(4))</code></pre><h3 id="5排序函数sorting">5、排序函数（Sorting）<a class="anchor" href="#5%e6%8e%92%e5%ba%8f%e5%87%bd%e6%95%b0sorting">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>sort_values()<span style="color:#960050;background-color:#1e0010">：</span>按值排序
</span></span><span style="display:flex;"><span>df_sorted <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;math&#39;</span>, ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>print(df_sorted[[<span style="color:#e6db74">&#39;name&#39;</span>, <span style="color:#e6db74">&#39;math&#39;</span>]])
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 输出：赵六96 → 周九90 → 李四92 → ...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">2. 按多个列排序：先按班级，再按数学成绩降序：&#34;</span>)
</span></span><span style="display:flex;"><span>df_sorted2 <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;class&#39;</span>, <span style="color:#e6db74">&#39;math&#39;</span>], ascending<span style="color:#f92672">=</span>[<span style="color:#66d9ef">True</span>, <span style="color:#66d9ef">False</span>])
</span></span><span style="display:flex;"><span>print(df_sorted2[[<span style="color:#e6db74">&#39;name&#39;</span>, <span style="color:#e6db74">&#39;class&#39;</span>, <span style="color:#e6db74">&#39;math&#39;</span>]])
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 先排A班，数学高的在前；再排B班</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">3. 按姓名字符串排序（升序）：&#34;</span>)
</span></span><span style="display:flex;"><span>df_sorted_name <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;name&#39;</span>, ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>print(df_sorted_name[[<span style="color:#e6db74">&#39;name&#39;</span>, <span style="color:#e6db74">&#39;math&#39;</span>]])
</span></span><span style="display:flex;"><span>中文按拼音排序<span style="color:#960050;background-color:#1e0010">：</span>陈七 <span style="color:#960050;background-color:#1e0010">→</span> 李四 <span style="color:#960050;background-color:#1e0010">→</span> 孙八 <span style="color:#960050;background-color:#1e0010">→</span> 王五 <span style="color:#960050;background-color:#1e0010">→</span> 张三 <span style="color:#960050;background-color:#1e0010">→</span> 赵六 <span style="color:#960050;background-color:#1e0010">→</span> 周九2<span style="color:#f92672">.</span>sort_index()<span style="color:#960050;background-color:#1e0010">：</span>按索引排序  <span style="color:#75715e"># 打乱索引示例</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df_shuffled <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>sample(frac<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)  <span style="color:#75715e"># 随机打乱行</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">打乱后：&#34;</span>)
</span></span><span style="display:flex;"><span>print(df_shuffled[[<span style="color:#e6db74">&#39;name&#39;</span>, <span style="color:#e6db74">&#39;math&#39;</span>]])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">按索引排序恢复：&#34;</span>)
</span></span><span style="display:flex;"><span>df_restored <span style="color:#f92672">=</span> df_shuffled<span style="color:#f92672">.</span>sort_index()
</span></span><span style="display:flex;"><span>print(df_restored[[<span style="color:#e6db74">&#39;name&#39;</span>, <span style="color:#e6db74">&#39;math&#39;</span>]])
</span></span><span style="display:flex;"><span>适用于索引有序但被打乱的情况</span></span></code></pre></div><h3 id="6apply方法数据转换利器">6、apply方法（数据转换利器）<a class="anchor" href="#6apply%e6%96%b9%e6%b3%95%e6%95%b0%e6%8d%ae%e8%bd%ac%e6%8d%a2%e5%88%a9%e5%99%a8">#</a></h3>
<p>apply可以对行、列、元素应用自定义函数。
1).对某一列使用apply</p>
<pre tabindex="0"><code>示例：判断数学是否优秀
def is_good_math(score):
return &#39;优秀&#39; if score &gt;= 90 else &#39;良好&#39;
df[&#39;math_level&#39;] = df[&#39;math&#39;].apply(is_good_math)
print(df[[&#39;name&#39;, &#39;math&#39;, &#39;math_level&#39;]])
示例：字符串处理（城市加“市”）
df[&#39;city_full&#39;] = df[&#39;city&#39;].apply(lambda x: x + &#34;市&#34;)
print(df[[&#39;city&#39;, &#39;city_full&#39;]])</code></pre><p>2).对多列使用</p>
<pre tabindex="0"><code>apply（axis = 1表示按行）
示例1：计算总分（跳过NaN）
def calculate_total(row):
return row[&#39;math&#39;] + row[&#39;english&#39;] + (row[&#39;science&#39;] if pd.notna(row[&#39;science&#39;]) else 0)
df[&#39;total&#39;] = df.apply(calculate_total, axis=1)
print(&#34;\n6. 每人总分：&#34;)
print(df[[&#39;name&#39;, &#39;math&#39;, &#39;english&#39;, &#39;science&#39;, &#39;total&#39;]])</code></pre><p>示例2：计算总分后，生成评语</p>
<pre tabindex="0"><code>def get_comment(row):
if row[&#39;total&#39;] &gt; 250:
return &#34;优秀&#34;
elif row[&#39;total&#39;] &gt; 230:
return &#34;良好&#34;
else:
return &#34;加油&#34;
df[&#39;comment&#39;] = df.apply(get_comment, axis=1)
print(&#34;\n7. 添加评语：&#34;)
print(df[[&#39;name&#39;, &#39;total&#39;, &#39;comment&#39;]])</code></pre><p>3).对整个Series或DataFrame使用apply</p>
<pre tabindex="0"><code>对多列同时 apply（比如标准化）
print(&#34;\n8. 数学成绩标准化（减均值除标准差）：&#34;)
mean = df[&#39;math&#39;].mean()
std = df[&#39;math&#39;].std()
df[&#39;math_std&#39;] = df[&#39;math&#39;].apply(lambda x: (x - mean) / std)
print(df[[&#39;name&#39;, &#39;math&#39;, &#39;math_std&#39;]].round(2))</code></pre><h2 id="四窗口函数window-functions">四、窗口函数（Window Functions）<a class="anchor" href="#%e5%9b%9b%e7%aa%97%e5%8f%a3%e5%87%bd%e6%95%b0window-functions">#</a></h2>
<p>Pandas 提供了 3 种窗口类型，常用于时间序列或顺序数据。我们先构造一个时间序列数据来演示：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#创建时间序列数据：某产品每日销量</span>
</span></span><span style="display:flex;"><span>dates <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74">&#39;2025-01-01&#39;</span>, periods<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>sales <span style="color:#f92672">=</span> [<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">120</span>, <span style="color:#ae81ff">110</span>, <span style="color:#ae81ff">130</span>, <span style="color:#ae81ff">140</span>, <span style="color:#ae81ff">135</span>, <span style="color:#ae81ff">150</span>, <span style="color:#ae81ff">160</span>, <span style="color:#ae81ff">155</span>, <span style="color:#ae81ff">170</span>]
</span></span><span style="display:flex;"><span>df_ts <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;date&#39;</span>: dates, <span style="color:#e6db74">&#39;sales&#39;</span>: sales})
</span></span><span style="display:flex;"><span>df_ts<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#39;date&#39;</span>, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;时间序列数据:&#34;</span>)
</span></span><span style="display:flex;"><span>print(df_ts)</span></span></code></pre></div><h3 id="滑动窗口">滑动窗口<a class="anchor" href="#%e6%bb%91%e5%8a%a8%e7%aa%97%e5%8f%a3">#</a></h3>
<p>rolling()（最常用）计算固定窗口大小的统计值，如“过去3天的平均销量”。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 3日移动平均</span>
</span></span><span style="display:flex;"><span>df_ts[<span style="color:#e6db74">&#39;ma_3&#39;</span>] <span style="color:#f92672">=</span> df_ts[<span style="color:#e6db74">&#39;sales&#39;</span>]<span style="color:#f92672">.</span>rolling(window<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)<span style="color:#f92672">.</span>mean()
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">1. 3日移动平均:&#34;</span>)
</span></span><span style="display:flex;"><span>print(df_ts[[<span style="color:#e6db74">&#39;sales&#39;</span>, <span style="color:#e6db74">&#39;ma_3&#39;</span>]])
</span></span><span style="display:flex;"><span>输出<span style="color:#960050;background-color:#1e0010">：</span> sales ma_3
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2025</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">100</span> NaN
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2025</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">120</span> NaN
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2025</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span> <span style="color:#ae81ff">110</span> <span style="color:#ae81ff">110.000000</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2025</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span> <span style="color:#ae81ff">130</span> <span style="color:#ae81ff">120.000000</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>前两行是 NaN<span style="color:#960050;background-color:#1e0010">，</span>因为不够3个数据</span></span></code></pre></div><h3 id="扩张窗口">扩张窗口<a class="anchor" href="#%e6%89%a9%e5%bc%a0%e7%aa%97%e5%8f%a3">#</a></h3>
<p>expanding()</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#从开始到当前的所有数据进行计算，如“累计平均”。</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#累计平均销量</span>
</span></span><span style="display:flex;"><span>df_ts[<span style="color:#e6db74">&#39;expanding_mean&#39;</span>] <span style="color:#f92672">=</span> df_ts[<span style="color:#e6db74">&#39;sales&#39;</span>]<span style="color:#f92672">.</span>expanding()<span style="color:#f92672">.</span>mean()
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">2. 累计平均:&#34;</span>)
</span></span><span style="display:flex;"><span>print(df_ts[[<span style="color:#e6db74">&#39;sales&#39;</span>, <span style="color:#e6db74">&#39;expanding_mean&#39;</span>]])
</span></span><span style="display:flex;"><span><span style="color:#75715e">#越往后，窗口越大，结果越稳定</span></span></span></code></pre></div><h3 id="指数加权窗口">指数加权窗口：<a class="anchor" href="#%e6%8c%87%e6%95%b0%e5%8a%a0%e6%9d%83%e7%aa%97%e5%8f%a3">#</a></h3>
<p>ewm()（Exponentially Weighted）越近的数据权重越高，适合趋势预测。</p>
<pre tabindex="0"><code>#指数加权移动平均（EWMA）
df_ts[&#39;ewm_mean&#39;] = df_ts[&#39;sales&#39;].ewm(alpha=0.3).mean()
print(&#34;\n3. 指数加权平均 (alpha=0.3):&#34;)
print(df_ts[[&#39;sales&#39;, &#39;ewm_mean&#39;]])
alpha 越大，越重视近期数据</code></pre><p>​</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">

<div>

</div>

<div>

</div>

</div>



  



  
  
  
  <div class="flex flex-wrap justify-between">
    <span>
    
      <a href="/Python/Python%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/Numpy/" class="flex align-center">
        <img src="/icons/backward.svg" class="book-icon" alt="Backward" />
        <span>Numpy</span>
      </a>
    
    </span>
    <span>
    
      <a href="/Python/Python%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/2.Pandas%E7%B4%A2%E5%BC%95/" class="flex align-center">
        <span>Pandas索引</span>
        <img src="/icons/forward.svg" class="book-icon" alt="Forward" />
      </a>
    
    </span>
  </div>
  


 
        
  
  <div class="book-comments">

</div>
  
 
        
        
  
 
        
  
  
    <script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script>
  

      </footer>

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
  
  <aside class="book-toc">
    <div class="book-toc-content">
      
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#一文件的读取和导入">一、文件的读取和导入</a>
      <ul>
        <li><a href="#数据读取">数据读取</a></li>
        <li><a href="#数据写入">数据写入</a></li>
      </ul>
    </li>
    <li><a href="#二基本数据结构">二、基本数据结构</a>
      <ul>
        <li><a href="#1-series">1. Series</a></li>
        <li><a href="#2-dataframe">2. DataFrame</a></li>
        <li><a href="#常用属性">常用属性</a></li>
      </ul>
    </li>
    <li><a href="#三常用基本函数">三、常用基本函数</a>
      <ul>
        <li><a href="#1汇总函数快速查看数据">1.汇总函数（快速查看数据）</a></li>
        <li><a href="#2特征统计函数对数值列操作">2、特征统计函数（对数值列操作）</a></li>
        <li><a href="#3唯一值函数处理分类--文本列">3、唯一值函数（处理分类 / 文本列）</a></li>
        <li><a href="#4替换函数replace">4、替换函数（replace）</a></li>
        <li><a href="#5排序函数sorting">5、排序函数（Sorting）</a></li>
        <li><a href="#6apply方法数据转换利器">6、apply方法（数据转换利器）</a></li>
      </ul>
    </li>
    <li><a href="#四窗口函数window-functions">四、窗口函数（Window Functions）</a>
      <ul>
        <li><a href="#滑动窗口">滑动窗口</a></li>
        <li><a href="#扩张窗口">扩张窗口</a></li>
        <li><a href="#指数加权窗口">指数加权窗口：</a></li>
      </ul>
    </li>
  </ul>
</nav>



    </div>
  </aside>
  
 
  </main>

  
</body>
</html>




















